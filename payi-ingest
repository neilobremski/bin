#!/usr/bin/env bash
#
# payi-ingest - Send ingest requests to the Pay-i API
# Shorthand for: payi <application> post /api/v1/ingest [args...]
#
# Usage:
#   payi-ingest <application> [--header value] [-param value] [json]
#   echo '{"json":...}' | payi-ingest <application>
#
# Examples:
#   payi-ingest my-app '{"category":"system.openai","resource":"gpt-4o","units":{"text":{"input":100}}}'
#   payi-ingest my-app --xProxy-UseCase-Name "classify" '{"category":"system.openai",...}'
#   cat payload.json | payi-ingest my-app
#

if [ $# -lt 1 ]; then
  echo "Usage: payi-ingest <application> [--header value] [-param value] [json]" >&2
  echo "" >&2
  exec payi
fi

app="$1"; shift
exec payi "$app" post /api/v1/ingest "$@"
